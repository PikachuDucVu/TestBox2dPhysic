{"ast":null,"code":"import { b2World } from \"box2d.ts\";\nimport { World } from \"flat-ecs\";\nimport { PolygonBatch, ShapeRenderer } from \"gdxts\";\nexport const createGameScreen = async (assetManager, viewport) => {\n  const createGround = (world, x, y, width, height) => {};\n\n  const gl = viewport.getContext();\n  const camera = viewport.getCamera();\n  const batch = new PolygonBatch(gl);\n  const shapeRenderer = new ShapeRenderer(gl);\n  camera.setYDown(true);\n  batch.setYDown(true);\n  gl.clearColor(0, 0, 0, 1);\n  const mapData = await fetch(\"./datas.tmj\").then(res => res.json());\n  const groundData = mapData.layers.find(w => w.name === \"Ground\").objects;\n  console.log(groundData);\n  const world = new World();\n  const physicWorld = new b2World({\n    x: 0,\n    y: 10\n  });\n  world.register(\"gl\", gl);\n  world.register(\"assetManager\", assetManager);\n  world.register(\"viewport\", viewport);\n  world.register(\"batch\", batch);\n  world.register(\"physicWorld\", physicWorld);\n  return {\n    update(delta) {\n      gl.clear(gl.COLOR_BUFFER_BIT);\n      batch.setProjection(camera.combined);\n      world.setDelta(delta);\n      world.processActiveSystem();\n      world.processPassiveSystem();\n      physicWorld.Step(delta, 8, 3);\n    },\n\n    dispose() {}\n\n  };\n};","map":{"version":3,"names":["b2World","World","PolygonBatch","ShapeRenderer","createGameScreen","assetManager","viewport","createGround","world","x","y","width","height","gl","getContext","camera","getCamera","batch","shapeRenderer","setYDown","clearColor","mapData","fetch","then","res","json","groundData","layers","find","w","name","objects","console","log","physicWorld","register","update","delta","clear","COLOR_BUFFER_BIT","setProjection","combined","setDelta","processActiveSystem","processPassiveSystem","Step","dispose"],"sources":["D:/projects/test-game/src/GameScreen/GameScreen.ts"],"sourcesContent":["import { b2World } from \"box2d.ts\";\r\nimport { World } from \"flat-ecs\";\r\nimport {\r\n  AssetManager,\r\n  PolygonBatch,\r\n  Screen,\r\n  ShapeRenderer,\r\n  Viewport,\r\n} from \"gdxts\";\r\n\r\nexport const createGameScreen = async (\r\n  assetManager: AssetManager,\r\n  viewport: Viewport\r\n): Promise<Screen> => {\r\n  const createGround = (\r\n    world: b2World,\r\n    x: number,\r\n    y: number,\r\n    width: number,\r\n    height: number\r\n  ) => {};\r\n\r\n  const gl = viewport.getContext();\r\n  const camera = viewport.getCamera();\r\n  const batch = new PolygonBatch(gl);\r\n  const shapeRenderer = new ShapeRenderer(gl);\r\n  camera.setYDown(true);\r\n  batch.setYDown(true);\r\n  gl.clearColor(0, 0, 0, 1);\r\n\r\n  const mapData = await fetch(\"./datas.tmj\").then((res) => res.json());\r\n  const groundData = mapData.layers.find(\r\n    (w: any) => w.name === \"Ground\"\r\n  ).objects;\r\n  console.log(groundData);\r\n\r\n  const world = new World();\r\n  const physicWorld = new b2World({\r\n    x: 0,\r\n    y: 10,\r\n  });\r\n\r\n  world.register(\"gl\", gl);\r\n  world.register(\"assetManager\", assetManager);\r\n  world.register(\"viewport\", viewport);\r\n  world.register(\"batch\", batch);\r\n  world.register(\"physicWorld\", physicWorld);\r\n\r\n  return {\r\n    update(delta: number) {\r\n      gl.clear(gl.COLOR_BUFFER_BIT);\r\n      batch.setProjection(camera.combined);\r\n      world.setDelta(delta);\r\n      world.processActiveSystem();\r\n      world.processPassiveSystem();\r\n      physicWorld.Step(delta, 8, 3);\r\n    },\r\n    dispose(): void {},\r\n  };\r\n};\r\n"],"mappings":"AAAA,SAASA,OAAT,QAAwB,UAAxB;AACA,SAASC,KAAT,QAAsB,UAAtB;AACA,SAEEC,YAFF,EAIEC,aAJF,QAMO,OANP;AAQA,OAAO,MAAMC,gBAAgB,GAAG,OAC9BC,YAD8B,EAE9BC,QAF8B,KAGV;EACpB,MAAMC,YAAY,GAAG,CACnBC,KADmB,EAEnBC,CAFmB,EAGnBC,CAHmB,EAInBC,KAJmB,EAKnBC,MALmB,KAMhB,CAAE,CANP;;EAQA,MAAMC,EAAE,GAAGP,QAAQ,CAACQ,UAAT,EAAX;EACA,MAAMC,MAAM,GAAGT,QAAQ,CAACU,SAAT,EAAf;EACA,MAAMC,KAAK,GAAG,IAAIf,YAAJ,CAAiBW,EAAjB,CAAd;EACA,MAAMK,aAAa,GAAG,IAAIf,aAAJ,CAAkBU,EAAlB,CAAtB;EACAE,MAAM,CAACI,QAAP,CAAgB,IAAhB;EACAF,KAAK,CAACE,QAAN,CAAe,IAAf;EACAN,EAAE,CAACO,UAAH,CAAc,CAAd,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB;EAEA,MAAMC,OAAO,GAAG,MAAMC,KAAK,CAAC,aAAD,CAAL,CAAqBC,IAArB,CAA2BC,GAAD,IAASA,GAAG,CAACC,IAAJ,EAAnC,CAAtB;EACA,MAAMC,UAAU,GAAGL,OAAO,CAACM,MAAR,CAAeC,IAAf,CAChBC,CAAD,IAAYA,CAAC,CAACC,IAAF,KAAW,QADN,EAEjBC,OAFF;EAGAC,OAAO,CAACC,GAAR,CAAYP,UAAZ;EAEA,MAAMlB,KAAK,GAAG,IAAIP,KAAJ,EAAd;EACA,MAAMiC,WAAW,GAAG,IAAIlC,OAAJ,CAAY;IAC9BS,CAAC,EAAE,CAD2B;IAE9BC,CAAC,EAAE;EAF2B,CAAZ,CAApB;EAKAF,KAAK,CAAC2B,QAAN,CAAe,IAAf,EAAqBtB,EAArB;EACAL,KAAK,CAAC2B,QAAN,CAAe,cAAf,EAA+B9B,YAA/B;EACAG,KAAK,CAAC2B,QAAN,CAAe,UAAf,EAA2B7B,QAA3B;EACAE,KAAK,CAAC2B,QAAN,CAAe,OAAf,EAAwBlB,KAAxB;EACAT,KAAK,CAAC2B,QAAN,CAAe,aAAf,EAA8BD,WAA9B;EAEA,OAAO;IACLE,MAAM,CAACC,KAAD,EAAgB;MACpBxB,EAAE,CAACyB,KAAH,CAASzB,EAAE,CAAC0B,gBAAZ;MACAtB,KAAK,CAACuB,aAAN,CAAoBzB,MAAM,CAAC0B,QAA3B;MACAjC,KAAK,CAACkC,QAAN,CAAeL,KAAf;MACA7B,KAAK,CAACmC,mBAAN;MACAnC,KAAK,CAACoC,oBAAN;MACAV,WAAW,CAACW,IAAZ,CAAiBR,KAAjB,EAAwB,CAAxB,EAA2B,CAA3B;IACD,CARI;;IASLS,OAAO,GAAS,CAAE;;EATb,CAAP;AAWD,CAjDM"},"metadata":{},"sourceType":"module"}